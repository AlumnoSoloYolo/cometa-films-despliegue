<div class="notifications">
    <div class="notifications__container">
        <div class="notifications__tabs">
            <button class="notifications__tab" [class.notifications__tab--active]="activeTab === 'solicitudes'"
                (click)="cambiarTab('solicitudes')" type="button">
                <i class="notifications__tab-icon bi bi-person-plus"></i>
                Solicitudes de seguimiento
                @if (followRequests.length > 0) {
                <span class="notifications__tab-badge">{{ followRequests.length }}</span>
                }
            </button>

            <button class="notifications__tab" [class.notifications__tab--active]="activeTab === 'notificaciones'"
                (click)="cambiarTab('notificaciones')" type="button">
                <i class="notifications__tab-icon bi bi-bell"></i>
                Notificaciones
            </button>
        </div>

        <div class="notifications__content">
            @if (activeTab === 'solicitudes') {
            <div class="notifications__section">
                <h1 class="notifications__title">Solicitudes de seguimiento</h1>

                @if (cargando) {
                <div class="notifications__loading">
                    <div class="notifications__spinner" role="status" aria-label="Cargando"></div>
                    <span>Cargando solicitudes...</span>
                </div>
                }

                @if (!cargando && followRequests.length === 0) {
                <div class="notifications__empty">
                    <i class="notifications__empty-icon bi bi-person-plus-fill" aria-hidden="true"></i>
                    <h2 class="notifications__empty-title">No tienes solicitudes pendientes</h2>
                    <p class="notifications__empty-description">
                        Cuando alguien quiera seguirte, aparecerán aquí sus solicitudes
                    </p>
                </div>
                }

                @if (!cargando && followRequests.length > 0) {
                <ul class="notifications__list" role="list">
                    @for (solicitud of followRequests; track solicitud._id) {
                    <li class="notifications__item">
                        <div class="notifications__user" [routerLink]="['/usuarios', solicitud.requester._id]"
                            role="button" [attr.aria-label]="'Ver perfil de ' + solicitud.requester.username">

                            <img [src]="getAvatarPath(solicitud.requester.avatar)"
                                [alt]="'Avatar de ' + solicitud.requester.username" class="notifications__avatar"
                                loading="lazy">

                            <div class="notifications__user-info">
                                <span class="notifications__username">
                                    {{ solicitud.requester.username }}
                                </span>
                                <time class="notifications__timestamp" [dateTime]="solicitud.createdAt">
                                    {{ solicitud.createdAt | date:'medium' }}
                                </time>
                            </div>
                        </div>

                        <div class="notifications__actions">
                            <button class="notifications__action notifications__action--accept"
                                (click)="aceptarSolicitud(solicitud._id)" type="button"
                                [attr.aria-label]="'Aceptar solicitud de ' + solicitud.requester.username">
                                Aceptar
                            </button>

                            <button class="notifications__action notifications__action--reject"
                                (click)="rechazarSolicitud(solicitud._id)" type="button"
                                [attr.aria-label]="'Rechazar solicitud de ' + solicitud.requester.username">
                                Rechazar
                            </button>
                        </div>
                    </li>
                    }
                </ul>
                }
            </div>
            }

            @if (activeTab === 'notificaciones') {
            <div class="notifications__section">
                <h1 class="notifications__title">Notificaciones del sistema</h1>

                <div class="notifications__empty">
                    <i class="notifications__empty-icon bi bi-bell-slash" aria-hidden="true"></i>
                    <h2 class="notifications__empty-title">No hay notificaciones</h2>
                    <p class="notifications__empty-description">
                        Aquí aparecerán las notificaciones importantes del sistema
                    </p>
                </div>
            </div>
            }
        </div>
    </div>
</div>